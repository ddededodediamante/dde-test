<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Personality Test — ddededodediamante</title>
</head>
<body>
  <h1 id="app-title">Personality Test — ddededodediamante</h1>

  <div id="quiz">
    <div id="pre">
      <button id="start">Start Quiz</button>
    </div>

    <div id="qwrap" hidden>
      <div id="progress"></div>
      <h2 id="qtext"></h2>
      <form id="qform"></form>
      <div>
        <button id="prev">Back</button>
        <button id="next">Next</button>
        <button id="submit" hidden>See Results</button>
      </div>
    </div>

    <div id="results" hidden></div>
  </div>

  <script>
    function byId(id){ return document.getElementById(id); }

    const CFG = {
      title: "Which ddededodediamante are you?",
      outcomes: [
        { id: "normal", name: "ddededodediamante", description: "i'm ddededodediamante" },
        { id: "evil", name: "evil ddededodediamante", description: "oh no evil go away" },
        { id: "fast", name: "fast ddededodediamante", description: "you are so fast and dodgy" },
        { id: "woman", name: "ddededodediamantella", description: "woman" },
        { id: "ququeque", name: "ququequequoquequiamante", description: "so like uhh you are cool" },
        { id: "joe", name: "Joe", description: "oh my god its joe" }
      ],
      questions: [
        {
          id: "q1",
          text: "You boot up your PC. What opens first?",
          choices: [
            { label: "discord or google", effects: { normal: 2 } },
            { label: "nuclear bomb launcher", effects: { evil: 2 } },
            { label: "a drawing app", effects: { ququeque: 2 } },
            { label: "one of my games", effects: { joe: 2 } }
          ]
        },
        {
          id: "q2",
          text: "How do you get stuff done?",
          choices: [
            { label: "quickly but sometimes messy", effects: { fast: 2 } },
            { label: "the laziest way", effects: { evil: 1, normal: 1 } },
            { label: "perfection", effects: { joe: 2, woman: 2 } },
            { label: "however i feel like it...", effects: { evil: 2 } }
          ]
        },
        {
          id: "q3",
          text: "A friend asks for help.",
          choices: [
            { label: "help them uwu", effects: { woman: 2, normal: 2 } },
            { label: "ignore and continue my path", effects: { evil: 3 } },
            { label: "help them, and dont expect anything in return", effects: { fast: 1, joe: 1, ququeque: 1 } },
            { label: "support them to finish their task", effects: { joe: 1, normal: 1 } }
          ]
        },
        {
          id: "q4",
          text: "How do you learn?",
          choices: [
            { label: "reading or speaking", effects: { woman: 2, normal: 1 } },
            { label: "listening", effects: { joe: 2 } },
            { label: "visually", effects: { fast: 2 } },
            { label: "a little bit of dat and dat", effects: { ququeque: 2, evil: 1 } }
          ]
        },
        {
          id: "q5",
          text: "loading question, please have patience...",
          choices: [
            { label: "i am a girl", effects: { woman: 2 } },
            { label: "dont worry!", effects: { ququeque: 2 } },
            { label: "hurry up plz", effects: { fast: 2, evil: 1 } },
            { label: "i got in a car crash", effects: { joe: 2 } }
          ]
        },
      ]
    };

    let idx = 0;
    const answers = {};

    function renderQuestion(){
      const q = CFG.questions[idx];
      if (!q) return;
      byId('qtext').textContent = q.text;
      byId('progress').textContent = 'Question ' + (idx+1) + ' / ' + CFG.questions.length;
      const form = byId('qform');
      form.innerHTML = '';
      q.choices.forEach((c, i) => {
        const id = q.id + '_' + i;
        const label = document.createElement('label');
        const input = document.createElement('input');
        input.type = 'radio'; input.name = q.id; input.value = i; input.id = id;
        if (answers[q.id] === i) input.checked = true;
        label.setAttribute('for', id);
        label.appendChild(input);
        label.appendChild(document.createTextNode(' ' + c.label));
        const div = document.createElement('div');
        div.appendChild(label);
        form.appendChild(div);
      });

      byId('prev').disabled = idx === 0;
      byId('next').hidden = idx === CFG.questions.length - 1;
      byId('submit').hidden = idx !== CFG.questions.length - 1;
    }

    function scoreResults(){
      const score = {};
      CFG.outcomes.forEach(o => score[o.id] = 0);
      CFG.questions.forEach(q => {
        const i = answers[q.id];
        if (i == null) return;
        const effects = (q.choices[i] && q.choices[i].effects) || {};
        for (const k in effects){ score[k] = (score[k] || 0) + Number(effects[k]); }
      });
      const totals = Object.entries(score).map(([id, val]) => ({ id, score: val }));
      totals.sort((a,b) => b.score - a.score);
      const topScore = totals.length ? totals[0].score : 0;
      let winners = totals.filter(t => t.score === topScore);
      return { totals, winners };
    }

    function renderResults(){
      const { totals, winners } = scoreResults();
      const byIdMap = {}; CFG.outcomes.forEach(o => byIdMap[o.id] = o);
      const div = byId('results');
      div.innerHTML = '';

      const h2 = document.createElement('h2');
      h2.textContent = winners.length > 1 ? 'You are a mix of:' : 'Your result:';
      div.appendChild(h2);

      winners.forEach(w => {
        const o = byIdMap[w.id] || { name: w.id, description: '' };
        const h3 = document.createElement('h3'); h3.textContent = o.name;
        const p = document.createElement('p'); p.textContent = o.description;
        const img = document.createElement('img'); img.src = `/images/${o.id}.png`;
        div.appendChild(h3); div.appendChild(p); div.appendChild(img);
      });

      const retake = document.createElement('button');
      retake.textContent = 'Retake';
      retake.onclick = () => { idx = 0; for (const k in answers) delete answers[k]; byId('results').hidden = true; byId('qwrap').hidden = false; renderQuestion(); };
      div.appendChild(retake);

      byId('qwrap').hidden = true;
      byId('results').hidden = false;
    }

    byId('start').onclick = () => { idx = 0; for (const k in answers) delete answers[k]; byId('pre').hidden = true; byId('qwrap').hidden = false; renderQuestion(); };
    byId('prev').onclick = () => { if (idx>0){ idx--; renderQuestion(); } };
    byId('next').onclick = () => {
      const q = CFG.questions[idx];
      const form = byId('qform');
      const checked = form.querySelector('input[type=radio]:checked');
      if (!checked){ alert('OwO, whats dis? pick an option!'); return; }
      answers[q.id] = Number(checked.value);
      if (idx < CFG.questions.length - 1){ idx++; renderQuestion(); }
    };
    byId('submit').onclick = () => {
      const q = CFG.questions[idx];
      const form = byId('qform');
      const checked = form.querySelector('input[type=radio]:checked');
      if (!checked){ alert('OwO, whats dis? pick an option!'); return; }
      answers[q.id] = Number(checked.value);
      renderResults();
    };
  </script>
</body>
</html>
